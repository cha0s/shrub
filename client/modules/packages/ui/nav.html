<!DOCTYPE html><html lang="en"><head><title>client/modules/packages/ui/nav</title></head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0"><meta name="groc-relative-root" content="../../../../"><meta name="groc-document-path" content="client/modules/packages/ui/nav"><meta name="groc-project-path" content="client/modules/packages/ui/nav.coffee"><meta name="groc-github-url" content="https://github.com/cha0s/shrub"><link rel="stylesheet" type="text/css" media="all" href="../../../../assets/style.css"><script type="text/javascript" src="../../../../assets/behavior.js"></script><body><div id="meta"><div class="file-path"><a href="https://github.com/cha0s/shrub/blob/master/client/modules/packages/ui/nav.coffee">client/modules/packages/ui/nav.coffee</a></div></div><div id="document"><div class="segment"><div class="code"><div class="wrapper"><span class="nx">exports</span><span class="p">.</span><span class="nv">$directive = </span><span class="o">-&gt;</span> <span class="p">[</span>
  <span class="s1">&#39;$location&#39;</span><span class="p">,</span> <span class="s1">&#39;ui/nav&#39;</span><span class="p">,</span> <span class="s1">&#39;socket&#39;</span><span class="p">,</span> <span class="s1">&#39;ui/title&#39;</span><span class="p">,</span> <span class="s1">&#39;user&#39;</span>
  <span class="nf">($location, nav, socket, title, user) -&gt;</span>
  
    <span class="nv">link: </span><span class="nf">(scope, elm, attr) -&gt;</span>
      
      <span class="nv">scope.navClass = </span><span class="k">if</span> <span class="nx">attr</span><span class="p">[</span><span class="s1">&#39;uiNav&#39;</span><span class="p">]</span> <span class="k">then</span> <span class="nx">attr</span><span class="p">[</span><span class="s1">&#39;uiNav&#39;</span><span class="p">]</span> <span class="k">else</span> <span class="s1">&#39;ui-nav&#39;</span>
    
      <span class="nv">scope.links = </span><span class="nx">nav</span><span class="p">.</span><span class="nx">links</span>
      <span class="nv">scope.user = </span><span class="nx">user</span><span class="p">.</span><span class="nx">instance</span><span class="p">()</span>
      
      <span class="nx">scope</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span>
        <span class="o">-&gt;</span> <span class="nx">title</span><span class="p">.</span><span class="nx">page</span><span class="nf">()</span>
<span class="nf">        -&gt;</span> <span class="nv">scope.pageTitle = </span><span class="nx">title</span><span class="p">.</span><span class="nx">page</span><span class="p">()</span>
      <span class="p">)</span>
      
      <span class="p">(</span><span class="nv">navActiveLinks = </span><span class="o">-&gt;</span>
      
        <span class="nv">path = </span><span class="nx">$location</span><span class="p">.</span><span class="nx">path</span><span class="p">()</span>
        <span class="k">for</span> <span class="nx">link</span> <span class="k">in</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">links</span><span class="p">()</span>
        
          <span class="nv">regexp = </span><span class="k">new</span> <span class="nb">RegExp</span> <span class="s2">&quot;^#{link.pattern}$&quot;</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;i&#39;</span><span class="p">]</span>
          <span class="nv">link.active = </span><span class="k">if</span> <span class="nx">regexp</span><span class="p">.</span><span class="nx">test</span> <span class="nx">path</span> <span class="k">then</span> <span class="s1">&#39;active&#39;</span>
          
      <span class="p">)()</span>
      </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Make sure we set active the first time, since angular-strap won't be ready.</p></div></div><div class="code"><div class="wrapper">      <span class="nx">scope</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span>
        <span class="o">-&gt;</span> <span class="nx">scope</span><span class="p">.</span><span class="nx">links</span><span class="p">()</span>
        <span class="nx">navActiveLinks</span>  
      <span class="p">)</span>

      <span class="nx">scope</span><span class="p">.</span><span class="nx">$watch</span><span class="p">(</span>
        <span class="o">-&gt;</span> <span class="nx">$location</span><span class="p">.</span><span class="nx">path</span><span class="p">()</span>
        <span class="nx">navActiveLinks</span>  
      <span class="p">)</span>
      
    <span class="nv">template: </span><span class="s2">&quot;&quot;&quot;</span>

<span class="s2">&lt;nav class=&quot;</span><span class="nx">navbar</span> <span class="nx">navbar</span><span class="o">-</span><span class="nx">default</span><span class="s2">&quot; role=&quot;</span><span class="nx">navigation</span><span class="s2">&quot;&gt;</span>
<span class="s2">  &lt;div class=&quot;</span><span class="nx">container</span><span class="o">-</span><span class="nx">fluid</span><span class="s2">&quot;&gt;</span>
<span class="s2">    </span>
<span class="s2">    &lt;div class=&quot;</span><span class="nx">navbar</span><span class="o">-</span><span class="nx">header</span><span class="s2">&quot;&gt;</span>
<span class="s2">      &lt;button type=&quot;</span><span class="nx">button</span><span class="s2">&quot; class=&quot;</span><span class="nx">navbar</span><span class="o">-</span><span class="nx">toggle</span><span class="s2">&quot; data-toggle=&quot;</span><span class="nx">collapse</span><span class="s2">&quot; data-target=&quot;</span><span class="p">.{{</span><span class="nx">navClass</span><span class="p">}}</span><span class="s2">&quot;&gt;</span>
<span class="s2">        &lt;span class=&quot;</span><span class="nx">sr</span><span class="o">-</span><span class="nx">only</span><span class="s2">&quot;&gt;Toggle navigation&lt;/span&gt;</span>
<span class="s2">        &lt;span class=&quot;</span><span class="nx">icon</span><span class="o">-</span><span class="nx">bar</span><span class="s2">&quot;&gt;&lt;/span&gt;</span>
<span class="s2">        &lt;span class=&quot;</span><span class="nx">icon</span><span class="o">-</span><span class="nx">bar</span><span class="s2">&quot;&gt;&lt;/span&gt;</span>
<span class="s2">        &lt;span class=&quot;</span><span class="nx">icon</span><span class="o">-</span><span class="nx">bar</span><span class="s2">&quot;&gt;&lt;/span&gt;</span>
<span class="s2">      &lt;/button&gt;</span>

<span class="s2">      &lt;a class=&quot;</span><span class="nx">navbar</span><span class="o">-</span><span class="nx">brand</span><span class="s2">&quot; href=&quot;</span><span class="c1">#&quot;&gt;&lt;span data-ng-bind=&quot;pageTitle&quot;&gt;&lt;/span&gt;&lt;/a&gt;</span>
      
    <span class="o">&lt;</span><span class="err">/div&gt;</span>
    
    <span class="o">&lt;</span><span class="nx">div</span> <span class="k">class</span><span class="o">=</span><span class="s2">&quot;navbar-collapse collapse&quot;</span> <span class="nx">data</span><span class="o">-</span><span class="nx">ng</span><span class="o">-</span><span class="k">class</span><span class="o">=</span><span class="s2">&quot;navClass&quot;</span><span class="o">&gt;</span>
      <span class="o">&lt;</span><span class="nx">p</span> <span class="k">class</span><span class="o">=</span><span class="s2">&quot;navbar-text navbar-right identity-wrapper&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">span</span> <span class="k">class</span><span class="o">=</span><span class="s2">&quot;identity&quot;</span><span class="o">&gt;</span>
          <span class="nx">You</span> <span class="nx">are</span> <span class="o">&lt;</span><span class="nx">span</span> <span class="k">class</span><span class="o">=</span><span class="s2">&quot;username&quot;</span> <span class="nx">data</span><span class="o">-</span><span class="nx">ng</span><span class="o">-</span><span class="nx">bind</span><span class="o">=</span><span class="s2">&quot;user.name&quot;</span><span class="o">&gt;&lt;</span><span class="err">/span&gt;</span>
        <span class="o">&lt;</span><span class="err">/span&gt;</span>
      <span class="o">&lt;</span><span class="err">/p&gt;</span>
      <span class="o">&lt;</span><span class="nx">ul</span> <span class="k">class</span><span class="o">=</span><span class="s2">&quot;nav navbar-nav navbar-right&quot;</span><span class="o">&gt;</span>
        <span class="o">&lt;</span><span class="nx">li</span> <span class="nx">data</span><span class="o">-</span><span class="nx">ng</span><span class="o">-</span><span class="k">class</span><span class="o">=</span><span class="s2">&quot;link.active&quot;</span> <span class="nx">data</span><span class="o">-</span><span class="nx">match</span><span class="o">-</span><span class="nx">route</span><span class="o">=</span><span class="s2">&quot;{{link.pattern}}&quot;</span> <span class="nx">data</span><span class="o">-</span><span class="nx">ng</span><span class="o">-</span><span class="nx">repeat</span><span class="o">=</span><span class="s2">&quot;link in links()&quot;</span><span class="o">&gt;</span>
          <span class="o">&lt;</span><span class="nx">a</span> <span class="nx">target</span><span class="o">=</span><span class="s2">&quot;{{link.target}}&quot;</span> <span class="nx">data</span><span class="o">-</span><span class="nx">ng</span><span class="o">-</span><span class="nx">href</span><span class="o">=</span><span class="s2">&quot;{{link.href}}&quot;</span> <span class="nx">data</span><span class="o">-</span><span class="nx">ng</span><span class="o">-</span><span class="nx">bind</span><span class="o">=</span><span class="s2">&quot;link.name&quot;</span><span class="o">&gt;&lt;</span><span class="err">/a&gt;</span>
        <span class="o">&lt;</span><span class="err">/li&gt;</span>
      <span class="o">&lt;</span><span class="err">/ul&gt;</span>
    <span class="o">&lt;</span><span class="err">/div&gt;</span>
    
  <span class="o">&lt;</span><span class="err">/div&gt;</span>
<span class="o">&lt;</span><span class="err">/nav&gt;</span>

<span class="s2">&quot;&quot;</span><span class="err">&quot;</span>
    
<span class="p">]</span>

<span class="nx">exports</span><span class="p">.</span><span class="nv">$service = </span><span class="o">-&gt;</span> <span class="p">[</span>
  <span class="o">-&gt;</span>
  </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>This API allows you to dynamically change the navigation links.</p></div></div><div class="code"><div class="wrapper">    
    <span class="nv">_links = </span><span class="p">[]</span>
    </div></div></div><div class="segment"><div class="comments"><div class="wrapper"><p>Get and set the navigation links. The links are objects structured like so:</p>

<ul>
<li>pattern: A string or regex containing the path to match to set this item
active.</li>
<li>href: Target navigation path when this item is clicked.</li>
<li>name: Human readable name for the item.</li>
</ul>

<p>e.g.</p>

<pre><code>item =
    pattern: '/home'
    href: '#/home'
    name: 'Home'
</code></pre></div></div><div class="code"><div class="wrapper">    
    <span class="vi">@links = </span><span class="o">-&gt;</span> <span class="nx">_links</span>
    <span class="vi">@setLinks = </span><span class="nf">(links) -&gt;</span> <span class="nv">_links = </span><span class="nx">links</span>
    
    <span class="k">return</span>
    
<span class="p">]</span></div></div></div></div></body></html>